if(typeof jQuery=="undefined"){console.warn("FiltEn requires jQuery library which was not loaded.")}else{if(typeof ko=="undefined"){console.warn("FiltEn requires KnockoutJS library which was not loaded.")}else{$(function(){var e=function(h,i){var f=this;f.products=[];f.criteria={};f.visibleCount=ko.observable(0);f.valueSelectionCB=function(){var p=[];for(var m=-1,q=Object.keys(f.criteria);++m<q.length;){var s=f.criteria[q[m]];var k=[];for(var l=-1,n=Object.keys(s.values);++l<n.length;){var r=s.values[n[l]];if(r.active()){k.push(r)}}if(k.length>0){p.push(k)}}var o=f.products.slice();$.each(p,function(w,v){var u=[];$.each(v,function(y,x){$.each(x.products,function(z,A){if(u.indexOf(A)<0){u.push(A)}})});var t=o.length;while(t--){if(u.indexOf(o[t])<0){o.splice(t,1)}}});$.each(f.products,function(t,u){u.visible(o.indexOf(u)>=0)});f.visibleCount(o.length)};var g=i||{};var j={};$(h).each(function(l,k){var m=new a(k);f.products.push(m);$.each(m.criteria,function(n,o){if(!j[n]){j[n]=new b(n,g[n.toLowerCase()],f.valueSelectionCB)}j[n].parseProduct(m,o)})});f.criteria=$.map(j,function(k){k.finalize();return k}).sort(function(l,k){return l.options.criteriaSortOrder-k.options.criteriaSortOrder});f.visibleCount(f.products.length)};var b=function(h,g,i){var f=this;f.name=h;f.valueMap={};f.valueSelectionCB=i;if(g){console.log("Found FiltEn options for '"+h+"'")}f.options=g||{};f.options.asRange=f.options.asRange||false;f.options.formatValue=f.options.formatValue||function(j){return j};f.options.valueSort=f.options.valueSort||function(l,k){var j=(typeof l=="string")?l.name.toUpperCase():l.name;var m=(typeof k=="string")?k.name.toUpperCase():k.name;return(j<m)?-1:(j>m)?1:0};if(typeof f.options.criteriaSortOrder==="undefined"){f.options.criteriaSortOrder=999}f.options.displayName=f.options.displayName||h;f.parseProduct=function(n,m){var j=[];if(f.options.delimeter){j=m.split(f.options.delimeter)}else{j.push(m)}for(var k=-1;++k<j.length;){var l=j[k];if(!f.valueMap[l]){f.valueMap[l]=new d(l,f.valueSelectionCB)}f.valueMap[l].addProduct(n)}};f.finalize=function(){f.values=$.map(f.valueMap,function(j){return j});if(f.options.asRange&&f.values.length>1){var k=Object.keys(f.valueMap);var w=[];if(k.length>1){var u=Math.min.apply(Math,k);var m=Math.max.apply(Math,k);var l=Math.pow(10,Math.ceil(Math.log(m-u)/Math.log(10))-1);var n=Math.floor(u/l)*l;var r=Math.ceil(m/l)*l;for(var p=n;p<r;p=p+l){var q={lower:p,upper:p+l};var t=new d(f.options.formatValue(q.lower)+" - "+f.options.formatValue(q.upper),f.valueSelectionCB);t.range=q;var s=k.length;while(s--){var v=k[s];if(v>t.range.lower&&v<=t.range.upper){for(var o=-1;++o<f.valueMap[v].products.length;){t.addProduct(f.valueMap[v].products[o])}k.splice(s,1)}}w.push(t);f.values=w}}}else{f.values.sort(f.options.valueSort)}f.valueMap=null}};var d=function(g,h){var f=this;f.name=g;f.products=[];f.active=ko.observable(false);f.addProduct=function(i){f.products.push(i)};f.count=function(){return f.products.length};f.countVisible=function(){var k=0;for(var j=0;j<f.products.length;j++){if(f.products[j].visible()){k++}}return k};f.toggleActive=function(){f.active(!f.active())};f.active.subscribe(h)};var a=function(h){var f=this;var g=$(h);f.dom=g;f.visible=ko.observable(true);f.criteria={};f.multifilters={};$.each(g.data(),function(j,i){if(/^filtenCrit/.test(j)){f.criteria[j.substring(10)]=i}});f.visible.subscribe(function(i){if(i){f.dom.show()}else{f.dom.hide()}})};var c=document.getElementById("filten");ko.applyBindings(new e(".filten-product",filtenCriteriaOptions),c);$(c).show()})}};